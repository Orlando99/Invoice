'use strict';invoicesUnlimited.controller('AccountActController',['$scope','$state','userFullFactory','signUpFactory',function(e,s,o,r){var l=r.getFactory('User');l.entity.length||s.go('login'),e.goNext=function(){r.getFactory('User').entity.length&&s.go('signup.merchantAccount')}}]);'use strict',invoicesUnlimited.controller('AccountInfoController',['$q','$rootScope','$scope','$state','signUpFactory','userFactory',function(e,s,o,r,l,d){function c(){for(var N in o.accountInfo)l.setField('AccountInfo',{field:N,value:o.accountInfo[N]});l.setField('AccountInfo',{field:'inPerson',value:!1});var S=l.create('AccountInfo');return S.then(function(C){var F;if(F=C.length?l.save('User',{accountInfo:C,company:o.businessName,phonenumber:o.phoneNumber}).then(function(){return l.save('BusinessInfo',{businessName:o.businessName,phoneNumber:o.phoneNumber})}):l.save('User',{accountInfo:l.getFactory('AccountInfo').entity[0],company:o.businessName,phonenumber:o.phoneNumber}).then(function(){return l.save('BusinessInfo',{businessName:o.businessName,phoneNumber:o.phoneNumber})}),F)return F})}function m(){for(var N in o.accountInfo)if(!o.accountInfo[N])return!1;return!0}if(!l.getFactory('User').entity.length)return void r.go('signup');var y,f=l.getFactory('User');if(e.when(d.entity[0].fetch()).then(function(N){y=N,o.businessName=''}),s.fromPaymentSettings){var h=l.getFactory('User').entity[0];l.setField('AccountInfo','userID',h),l.setField('AccountInfo','organization',h.get('selectedOrganization')),showLoader();debugger;l.getFactory('Role').load().then(function(){hideLoader()},function(N){hideLoader(),console.log(N.message)})}$('input').keyup(function(N){var S=N.target.id;$('#'+S+'-error').css('display','none'),$('#'+S).removeClass('error')}),$('select').bind('change keyup',function(N){var S=N.target.id;$('#'+S+'-error').css('display','none'),$('#'+S).removeClass('error')}),$.validator.addMethod('AvgSaleRequired',function(N){return'avgSaleTitle'!=N}),$.validator.addMethod('MonthlySalesRequired',function(N){return'monthlySalesTitle'!=N}),$('[name=routingNumber]').mask('000000000'),$('[name=accountNumber]').mask('0000000000'),$('.mobilePhone').mask('9 (999) 999-9999',mobileOptions),$('#signUpForm').validate({onfocusout:!0,rules:{avgSale:{required:!0,AvgSaleRequired:!0},monthlySales:{required:!0,MonthlySalesRequired:!0},bankName:'required',routingNumber:'required',accountNumber:'required',phoneNumber:'required',businessName:'required'},messages:{avgSale:'Please specify your average sale per customer!',monthlySales:'Please specify your estimated montly credit card sales!',bankName:'Please specify your bank name!',routingNumber:'Please specify your bank routing number!',accountNumber:'Please specify your bank account number!',phoneNumber:'Please specify your phone number!',businessName:'Please specify your business name!'}}),o.avgSaleList=[],o.monthlySalesList=[];var I=0;do I?1==I?I=5:100>I?I+=5:1e3>I?I+=50:1e4>I?I+=500:I+=5e3:I=1,o.avgSaleList.push({value:'$ '+(5e4==I?I+'+':I)});while(5e4!=I);I=0;do I+=25000>I?500:5e3,o.monthlySalesList.push({value:'$ '+(1e5==I?I+'+':I)});while(1e5!=I);o.accountInfo={bankName:'',routingNumber:'',accountNumber:'',avgSale:'',monthlySales:''},o.saveAccountInfo=function(){$('#signUpForm').valid()&&(showLoader(),c().then(function(){hideLoader(),r.go('signup.signature')},function(N){hideLoader(),console.log(N.message)}))},o.saveAndContinueLater=function(){return m()?$('#signUpForm').valid()?void(showLoader(),c().then(function(){hideLoader(),l.getFactory('User').entity.length&&r.go('signup.invoiceTemplateInfo')},function(N){hideLoader(),console.log(N.message)})):void showLoader():(showLoader(),void r.go('signup.invoiceTemplateInfo'))}}]);'use strict',$(document).ready(function(){$.validator.addMethod('OwhershipTypeNotSelected',function(e){return'Ownership Type'!=e}),$.validator.addMethod('FederalTaxIDisMissing',function(e,s){if('none'==$(s).css('display'))return!0;return''!=e}),$.validator.addMethod('exactlength',function(e,s,o){return e.length==o})}),invoicesUnlimited.controller('BusinessInfoController',['$q','$rootScope','$scope','$state','signUpFactory','userFactory','roleFactory',function(e,s,o,r,l,d){function g(){if('signup.invoiceTemplateInfo'==C||$('#signUpForm').valid()){for(var P in l.setDefaultValues(),showLoader(),o.bsnsInfo)l.setField('BusinessInfo',{field:P,value:o.bsnsInfo[P]});var B=l.create('BusinessInfo');B.then(function(k){return k.length?l.save('User',{businessInfo:k}):l.save('User',{businessInfo:l.getFactory('BusinessInfo').entity[0]})},function(k){k.length||console.log(k.message),k.forEach(function(A){console.log(A.message)})}).then(function(){m()},errorCallback)}}function m(){showLoader(),h.set('fullName',o.fullName),e.when(y.save()).then(function(){f().then(function(){hideLoader(),r.go(C)},function(P){hideLoader(),console.log(P.message)})})}function f(){o.principalInfo.dob=formatDate(o.dob,'MM-DD-YYYY');debugger;for(var P in o.toggleHomeChecked&&F.forEach(function(k){o.principalInfo[k]=o.bsnsInfo[k]}),o.principalInfo)l.setField('PrincipalInfo',{field:P,value:o.principalInfo[P]});var B=l.create('PrincipalInfo');return B.then(function(k){var A;if(A=k.length?l.save('User',{principalInfo:k}):l.save('User',{principalInfo:l.getFactory('PrincipalInfo').entity[0]}),A)return A})}if(!d.entity.length)return void r.go('signup');var h,y=l.getFactory('User');if(e.when(d.entity[0].fetch()).then(function(P){h=P}),s.fromPaymentSettings){var I=d.entity[0];l.setField('PrincipalInfo','userID',I),l.setField('PrincipalInfo','organization',I.get('selectedOrganization')),showLoader();var N,S=[];N=e.when(I.get('businessInfo').fetch()).then(function(P){for(var B=0;B<F.length;++B)l.setField('BusinessInfo',F[B],P.get(F[B]));o.bsnsInfo=P,o.toggleHomeInfo()}),S.push(N),N=e.when(l.getFactory('Role').load()),S.push(N),e.all(S).then(function(){hideLoader()},function(P){hideLoader(),console.log(P.message)})}$('input').keyup(function(P){var B=P.target.id;$('#'+B+'-error').css('display','none'),$('#'+B).removeClass('error')}),$('#dob').keyup(function(){var P=$('#dob').val();if(!P.length)$('#dob').unmask(),$('#dob').mask('AY/S0/0000',{translation:{A:{pattern:/[0-9]/},Y:{pattern:/[0-9]/},S:{pattern:/[0-9]/}}});else if(1==P.length){if(1<P&&10>P){$('#dob').unmask();var B='0';B+=P,$('#dob').val(B)}var k=parseInt(P.charAt(0));1==k?($('#dob').unmask(),$('#dob').mask('AY/S0/0000',{translation:{A:{pattern:/[0-1]/},Y:{pattern:/[0-2]/},S:{pattern:/[0-9]/}}})):($('#dob').unmask(),$('#dob').mask('AY/S0/0000',{translation:{A:{pattern:/[0-1]/},Y:{pattern:/[0-9]/},S:{pattern:/[0-9]/}}}))}else if(2==P.length||3==P.length)$('#dob').unmask(),$('#dob').mask('A0/SY/0000',{translation:{A:{pattern:/[0-1]/},Y:{pattern:/[0-9]/},S:{pattern:/[0-9]/}}});else if(4==P.length){var k=parseInt(P.charAt(3));if(3<k&&10>k){var A=$('#dob').val().split('/'),U='0';U+=k;var w=A[0]+'/'+U;$('#dob').val(w)}3==k?($('#dob').unmask(),$('#dob').mask('A0/SY/0000',{translation:{A:{pattern:/[0-1]/},Y:{pattern:/[0-1]/},S:{pattern:/[0-3]/}}})):($('#dob').unmask(),$('#dob').mask('A0/SY/0000',{translation:{A:{pattern:/[0-1]/},Y:{pattern:/[0-9]/},S:{pattern:/[0-9]/}}}))}else $('#dob').unmask(),$('#dob').mask('AY/S0/0000',{translation:{A:{pattern:/[0-1]/},Y:{pattern:/[0-9]/},S:{pattern:/[0-3]/}}})}),$('#dob').mask('AY/S0/0000',{translation:{A:{pattern:/[0-9]/},Y:{pattern:/[0-9]/},S:{pattern:/[0-9]/}}}),$('#signUpForm').validate({onkeyup:function(P){$(P).valid()},onfocusout:!1,rules:{company:'required',fullName:'required',dob:'required',ssn:'required',streetName:'required',city:'required',state:'required',zipCode:'required',ownershipType:{OwhershipTypeNotSelected:!0},federalTaxID:{FederalTaxIDisMissing:!0,exactlength:10}},messages:{company:'Please specify your business name!',streetName:'Please specify your business street name!',city:'Please specify your business city!',state:'Please specify your business state!',dob:'Please specify your Date Of Birth!',ssn:'Please specify your SSN!',fullName:'Please specify your Full Name!',zipCode:'Please specify your business zip code!',ownershipType:{OwhershipTypeNotSelected:'Please select your ownership type!'},federalTaxID:{FederalTaxIDisMissing:'Please specify your Federal Tax ID!',exactlength:'Please enter exactly 9 digits'}}}),$('input[name="federalTaxID"]').mask('00-0000000'),d.entity[0].get('company'),o.bsnsInfo={businessName:'',streetName:'',city:'',state:'',zipCode:'',federalTaxID:'',ownershipType:'Ownership Type'},o.options=[{name:'ownershipTitle',value:'Ownership Type'},{name:'Individual or Sole Proprietor',value:'Individual or Sole Proprietor'},{name:'Limited Liability Compnay',value:'Limited Liability Compnay'},{name:'Non Profit',value:'Non Profit'},{name:'S-Corporation',value:'S-Corporation'},{name:'C-Corporation',value:'C-Corporation'},{name:'Partenership',value:'Partenership'}];var C='signup.account-info';o.saveAndLaterBusinessInfo=function(){return C='signup.invoiceTemplateInfo',void g()},o.saveBusinessInfo=g,$('.federal-tax-id-input').hide(),$('.ownershipTypeInput').show(),o.federalTaxIdClick=function(){var P=o.x2;$('.federal-tax-id-input').hide(),o.bsnsInfo.federalTaxID='',!0==P&&$('.federal-tax-id-input').show()},$('[name=ssn]').mask('000-00-0000'),o.toggleHomeChecked=!0,o.principalInfo={streetName:'',city:'',state:'',zipCode:'',dob:'',ssn:'',ownershipType:''};var F=['streetName','city','state','zipCode','ownershipType'];o.toggleHomeInfo=function(){F.forEach(function(P){o.principalInfo[P]=o.bsnsInfo[P]})},o.openDatePicker=function(P){1===P?o.openPicker1=!0:void 0}}]);'use strict',invoicesUnlimited.controller('ConfirmController',['$scope','$state','userFullFactory','signUpFactory',function(e,s,o,r){var d=r.getFactory('User');d.entity.length||s.go('signup'),e.getStarted1=function(){r.getFactory('User').entity.length&&(r.getFactory('User').entity[0].get('tutorial')?s.go('dashboard'):s.go('signup.invoiceTemplateInfo'))}}]);'use strict',invoicesUnlimited.controller('InvoiceTemplateInfoController',['$q','$rootScope','$scope','$state','signUpFactory','userFactory','roleFactory',function(e,s,o,r,l,d){function m(){var N='',S;o.fullName&&(S=o.fullName.split(' ')[0],1<o.fullName.split(' ').length&&(N=o.fullName.split(' ')[1]));var C={company:o.bsnsInfo.businessName,mobile_phone:o.bsnsInfo.phoneNumber,home_phone:o.bsnsInfo.phoneNumber,business_phone:o.bsnsInfo.phoneNumber,email_address:h.get('email'),first_name:S,last_name:N,position:IRIS_SOURCE};l.submitLeadToAggregator(C)}function f(){var N=h.get('principalInfo'),S=h.get('accountInfo');S?{status:'New Lead',list:IRIS_SOURCE,BusinessName:o.bsnsInfo.businessName,Email:h.get('email'),BusinessAddress:o.bsnsInfo.streetName,MailingAddress:o.bsnsInfo.streetName,BusinessState:o.bsnsInfo.state,MailingState:o.bsnsInfo.state,BusinessZip:o.bsnsInfo.zipCode,MailingZIP:o.bsnsInfo.zipCode,BusinessCity:o.bsnsInfo.city,MailingCity:o.bsnsInfo.city,OfficePhone:o.bsnsInfo.phoneNumber,MailingContact:o.bsnsInfo.phoneNumber,ContactName:o.fullName,HomeAddress:N.get('streetName'),State2:N.get('state'),Zip:N.get('zipCode'),City2:N.get('city'),DateOfBirthMmDdYyyy:N.get('dob'),SocialSecurity:N.get('ssn'),BankName:S.get('bankName'),BankRouting:S.get('routingNumber'),BankAccount2:S.get('accountNumber'),Business_Volume:S.get('monthlySales')}:N?{status:'New Lead',list:IRIS_SOURCE,BusinessName:o.bsnsInfo.businessName,Email:h.get('email'),BusinessAddress:o.bsnsInfo.streetName,MailingAddress:o.bsnsInfo.streetName,BusinessState:o.bsnsInfo.state,MailingState:o.bsnsInfo.state,BusinessZip:o.bsnsInfo.zipCode,MailingZIP:o.bsnsInfo.zipCode,BusinessCity:o.bsnsInfo.city,MailingCity:o.bsnsInfo.city,OfficePhone:o.bsnsInfo.phoneNumber,MailingContact:o.bsnsInfo.phoneNumber,ContactName:o.fullName,HomeAddress:N.get('streetName'),State2:N.get('state'),Zip:N.get('zipCode'),City2:N.get('city'),DateOfBirthMmDdYyyy:N.get('dob'),SocialSecurity:N.get('ssn')}:{status:'New Lead',list:IRIS_SOURCE,BusinessName:o.bsnsInfo.businessName,Email:h.get('email'),BusinessAddress:o.bsnsInfo.streetName,MailingAddress:o.bsnsInfo.streetName,BusinessState:o.bsnsInfo.state,MailingState:o.bsnsInfo.state,BusinessZip:o.bsnsInfo.zipCode,MailingZIP:o.bsnsInfo.zipCode,BusinessCity:o.bsnsInfo.city,MailingCity:o.bsnsInfo.city,OfficePhone:o.bsnsInfo.phoneNumber,MailingContact:o.bsnsInfo.phoneNumber,ContactName:o.fullName}}function y(){var N=h.get('principalInfo'),S=h.get('accountInfo'),C;C=S?'Business Name: '+o.bsnsInfo.businessName+'<br><br>Email: '+h.get('email')+'<br><br>Business Address: '+o.bsnsInfo.streetName+'<br><br>Business State: '+o.bsnsInfo.state+'<br><br>Business Zip: '+o.bsnsInfo.zipCode+'<br><br>Business City: '+o.bsnsInfo.city+'<br><br>Office Phone: '+o.bsnsInfo.phoneNumber+'<br><br>Contact Name: '+o.fullName+'<br><br>Home Address: '+N.get('streetName')+'<br><br>Home State: '+N.get('state')+'<br><br>Home Zip: '+N.get('zipCode')+'<br><br>Home City: '+N.get('city')+'<br><br>Date Of Birth: '+N.get('dob')+'<br><br>Social Security: '+N.get('ssn')+'<br><br>Bank Name: '+S.get('bankName')+'<br><br>Bank Routing: '+S.get('routingNumber')+'<br><br>Bank Account: '+S.get('accountNumber')+'<br><br>Monthly Volume'+S.get('monthlySales'):N?'Business Name: '+o.bsnsInfo.businessName+'<br><br>Email: '+h.get('email')+'<br><br>Business Address: '+o.bsnsInfo.streetName+'<br><br>Business State: '+o.bsnsInfo.state+'<br><br>Business Zip: '+o.bsnsInfo.zipCode+'<br><br>Business City: '+o.bsnsInfo.city+'<br><br>Office Phone: '+o.bsnsInfo.phoneNumber+'<br><br>Contact Name: '+o.fullName+'<br><br>Home Address: '+N.get('streetName')+'<br><br>Home State: '+N.get('state')+'<br><br>Home Zip: '+N.get('zipCode')+'<br><br>Home City: '+N.get('city')+'<br><br>Date Of Birth: '+N.get('dob')+'<br><br>Social Security: '+N.get('ssn'):'Business Name: '+o.bsnsInfo.businessName+'<br><br>Email: '+h.get('email')+'<br><br>Business Address: '+o.bsnsInfo.streetName+'<br><br>Business State: '+o.bsnsInfo.state+'<br><br>Business Zip: '+o.bsnsInfo.zipCode+'<br><br>Business City: '+o.bsnsInfo.city+'<br><br>Office Phone: '+o.bsnsInfo.phoneNumber+'<br><br>Contact Name: '+o.fullName,Parse.Cloud.run('sendMailgunHtml',{toEmail:LEAD_EMAIL,fromEmail:'no-reply@invoicesunlimited.com',subject:'New Lead From: '+IRIS_SOURCE,html:'<p>'+C+'</p>'}).then(function(F){debugger;console.log(F)},function(){debugger;console.log(msg)})}if(!d.entity.length)return void r.go('signup');var h,I;showLoader(),e.when(d.entity[0].fetch()).then(function(N){h=N;var S=N.get('businessInfo');o.fullName=N.get('fullName'),S?e.when(S.fetch()).then(function(C){I=C,o.bsnsInfo=C,o.bsnsInfo.businessName=C.get('businessName'),o.bsnsInfo.streetName=C.get('streetName'),o.bsnsInfo.city=C.get('city'),o.bsnsInfo.state=C.get('state'),o.bsnsInfo.zipCode=C.get('zipCode'),o.bsnsInfo.phoneNumber=C.get('phoneNumber'),hideLoader()}):hideLoader()}),$('input').keyup(function(N){var S=N.target.id;$('#'+S+'-error').css('display','none'),$('#'+S).removeClass('error')}),$('#signUpForm').validate({onkeyup:function(N){$(N).valid()},onfocusout:!1,rules:{company:'required',fullName:'required',streetName:'required',city:'required',state:'required',zipCode:'required',phoneNumber:{minlength:10,required:!0}},messages:{streetName:'Please specify your business street name!',city:'Please specify your business city!',state:'Please specify your business state!',fullName:'Please specify your Full Name!',zipCode:'Please specify your business zip code!',company:'Please specify your business name',phoneNumber:{minlength:'Please enter a valid phone number!',required:'Please specify your phone number!'}}}),o.bsnsInfo={streetName:'',city:'',state:'',zipCode:''},o.saveBusinessInfo=function(){if($('#signUpForm').valid()){showLoader();var N=o.bsnsInfo;if(!I){var S=new Parse.Object.extend('BusinessInfo');I=new S}I.set('businessName',N.businessName),I.set('streetName',N.streetName),I.set('city',N.city),I.set('state',N.state),I.set('zipCode',N.zipCode),I.set('phoneNumber',N.phoneNumber),I.set('userID',h),I.set('organization',h.get('selectedOrganization')),e.when(I.save()).then(function(C){h.set('company',N.businessName),h.set('fullName',o.fullName),h.set('phonenumber',N.phoneNumber),h.set('tutorial',1),h.set('businessInfo',C),m(),h.get('signatureImage')||(f(),y()),e.when(h.save()).then(function(F){var P=new Parse.Query('ProjectUser');P.equalTo('userName',F.get('username')),e.when(P.first()).then(function(B){B.set('title',o.fullName),B.set('companyName',o.bsnsInfo.businessName),e.when(B.save()).then(function(){fromTutorial=!0,hideLoader(),r.go('dashboard.settings.app-preferences')})})})})}},o.nextClicked=function(){$('.tutorial').hide()},$(document).click(function(){$('.tutorial').hide()}),$('.mobilePhone').mask('9 (999) 999-9999',mobileOptions)}]);'use strict',invoicesUnlimited.controller('MerchantAccountController',['$rootScope','$scope','$state','userFullFactory','signUpFactory','userFactory','roleFactory',function(e,s,o,r,l,d){function g(){for(var y in showLoader(),l.setDefaultValues(),s.bsnsInfo)l.setField('BusinessInfo',{field:y,value:s.bsnsInfo[y]});l.setField('BusinessInfo',{field:'businessName',value:''});var h=l.create('BusinessInfo');h.then(function(I){return l.save('User',{businessInfo:I})},function(I){I.length||console.log(I.message),I.forEach(function(N){console.log(N.message)})}).then(function(){hideLoader(),o.go('signup.invoiceTemplateInfo')},errorCallback)}var m=l.getFactory('User');if(m.entity.length||o.go('signup'),s.goNext=function(){l.getFactory('User').entity.length&&o.go('signup.business-info')},s.skipStep=function(){g()},e.fromPaymentSettings){var f=d.entity[0];l.setField('User','company',f.get('company')),l.setField('BusinessInfo','organization',f.get('selectedOrganization'))}}]);'use strict',invoicesUnlimited.controller('PrincipalInfoController',['$q','$rootScope','$scope','$state','signUpFactory','userFactory',function(e,s,o,r,l,d){function c(){for(var C in o.principalInfo.dob=formatDate(o.dob,'MM-DD-YYYY'),o.principalInfo)l.setField('PrincipalInfo',{field:C,value:o.principalInfo[C]});var F=l.create('PrincipalInfo');return F.then(function(P){var B=l.save('User',{principalInfo:P});if(B)return B})}function g(){return h.forEach(function(C){if(!o.principalInfo[C])return!1}),o.dob&&o.principalInfo.ssn}var f,m=l.getFactory('User');if(e.when(d.entity[0].fetch()).then(function(C){f=C}),$('[name=ssn]').mask('000-00-0000'),!l.getFactory('User').entity.length)return void r.go('signup');if($('input').keyup(function(C){var F=C.target.id;$('#'+F+'-error').css('display','none'),$('#'+F).removeClass('error')}),!l.getVerification.code()&&!s.fromPaymentSettings)return m.logout(),void r.go('signup');$('#signUpForm').validate({onkeyup:function(C){$(C).valid()},onfocusout:!1,rules:{streetName:'required',city:'required',state:'required',zipCode:'required',dob:'required',ssn:'required',fullName:'required'},messages:{streetName:'Please specify your street name!',city:'Please specify your city!',state:'Please specify your state!',zipCode:'Please specify your zip code!',dob:'Please specify your Date Of Birth!',ssn:'Please specify your SSN!',fullName:'Please specify your Full Name!'}});var y=function(C){return l.getField('BusinessInfo',C)};o.principalInfo={streetName:y('streetName'),city:y('city'),state:y('state'),zipCode:y('zipCode'),dob:'',ssn:''},o.fullName='',o.toggleHomeChecked=!0;var h=['streetName','city','state','zipCode'];if(o.toggleHomeInfo=function(){h.forEach(function(C){o.principalInfo[C]=o.toggleHomeChecked?y(C):''})},s.fromPaymentSettings){var I=m.entity[0];l.setField('PrincipalInfo','userID',I),l.setField('PrincipalInfo','organization',I.get('selectedOrganization')),showLoader();var N,S=[];N=e.when(I.get('businessInfo').fetch()).then(function(C){for(var F=0;F<h.length;++F)l.setField('BusinessInfo',h[F],C.get(h[F]));o.toggleHomeInfo()}),S.push(N),N=e.when(l.getFactory('Role').load()),S.push(N),e.all(S).then(function(){hideLoader()},function(C){hideLoader(),console.log(C.message)})}o.$watch(function(){return l.get('BusinessInfo')},function(C,F){F==C||h.forEach(function(P){o.principalInfo[P]=C[P]})},!0),o.savePrincipalInfo=function(){$('#signUpForm').valid()&&(showLoader(),f.set('fullName',o.fullName),e.when(m.save()).then(function(){c().then(function(){hideLoader(),r.go('signup.account-info')},function(C){hideLoader(),console.log(C.message)})}))},o.saveAndContinueLater=function(){return g()?void(!$('#signUpForm').valid()||(showLoader(),c().then(function(){hideLoader(),l.getFactory('User').entity.length&&r.go('dashboard')},function(C){hideLoader(),console.log(C.message)}))):void r.go('dashboard')},o.openDatePicker=function(C){1===C?o.openPicker1=!0:void 0}}]);'use strict',invoicesUnlimited.controller('SignatureController',['$rootScope','$scope','$state','signUpFactory','$ocLazyLoad',function(e,s,o,r){function d(){var m=c.entity[0],f=m.get('businessInfo'),y=m.get('principalInfo'),h=m.get('accountInfo'),I;I='Business Name: '+f.get('businessName')+'<br><br>Email: '+m.get('email')+'<br><br>Business Address: '+f.get('streetName')+'<br><br>Business State: '+f.get('state')+'<br><br>Business Zip: '+f.get('zipCode')+'<br><br>Business City: '+f.get('city')+'<br><br>Office Phone: '+f.get('phoneNumber')+'<br><br>Contact Name: '+m.fullName+'<br><br>Home Address: '+y.get('streetName')+'<br><br>Home State: '+y.get('state')+'<br><br>Home Zip: '+y.get('zipCode')+'<br><br>Home City: '+y.get('city')+'<br><br>Date Of Birth: '+y.get('dob')+'<br><br>Social Security: '+y.get('ssn')+'<br><br>Bank Name: '+h.get('bankName')+'<br><br>Bank Routing: '+h.get('routingNumber')+'<br><br>Bank Account: '+h.get('accountNumber')+'<br><br>Bank Account: '+h.get('accountNumber')+'<br><br>Monthly Volume: '+h.get('monthlySales')+'<br><br>Signature URL: '+m.get('signatureImage').get('imageFile')._url,Parse.Cloud.run('sendMailgunHtml',{toEmail:LEAD_EMAIL,fromEmail:'no-reply@invoicesunlimited.com',subject:'New Lead From: '+IRIS_SOURCE,html:'<p>'+I+'</p>'}).then(function(N){debugger;console.log(N)},function(){debugger;console.log(msg)})}var c=r.getFactory('User');if(!c.entity.length)return void o.go('signup');if(e.fromPaymentSettings){var g=c.entity[0];r.setField('User','fullName',g.get('fullName')),r.setField('Signature','userID',g),r.setField('Signature','organization',g.get('selectedOrganization')),showLoader(),r.getFactory('Role').load().then(function(){hideLoader()},function(m){hideLoader(),console.log(m.message)})}$('#sig').signature(),$('#clear').click(function(){$('#sig').signature('clear')}),s.fullName=r.getField('User','fullName'),$('h2.text-uppercase').css({padding:'50px 0',margin:0}),$('.signature').css({height:$(window).height()-$('.sticky-nav').height()-2*parseInt($('.sticky-nav').css('padding-top'))-1}),s.submitSignature=function(){var m=!1,f=!1;if($('#sigForm').validate().resetForm(),$('#sig').signature('isEmpty')?$('#sigForm').validate().showErrors({sigError:'Please provide signature'}):m=!0,$('input[name="agree-box"]:checked').length?f=!0:$('#sigForm').validate().showErrors({'agree-box':'Please agree to the Terms'}),!!(m&&f)){showLoader();var y=$('.kbw-signature canvas')[0].toDataURL().replace('data:image/png;base64,','');r.setField('Signature',{field:'imageName',value:'Signature_'+c.entity[0].id}),r.setField('Signature',{field:'imageFile',value:new Parse.File('Signature.png',{base64:y})});var h=r.create('Signature');return h?void h.then(function(){var N=r.save('User',{signatureImage:r.getFactory('Signature').entity[0]});return N?N:void window.reload()},function(I){console.log(I.messge)}).then(function(){debugger;d();var F,P,I=c.entity[0],N=I.get('businessInfo'),S=I.get('principalInfo'),C=I.get('accountInfo');I.fullName&&(P=I.fullName.split(' ')[0],1<I.fullName.split(' ').length&&(F=s.fullName.split(' ')[1]));var B;B={status:'New Lead',list:IRIS_SOURCE,BusinessName:N.get('businessName'),Email:I.get('email'),BusinessAddress:N.get('streetName'),MailingAddress:N.get('streetName'),BusinessState:N.get('state'),MailingState:N.get('state'),BusinessZip:N.get('zipCode'),MailingZIP:N.get('zipCode'),BusinessCity:N.get('city'),MailingCity:N.get('city'),OfficePhone:N.get('phoneNumber'),MailingContact:N.get('phoneNumber'),ContactName:I.fullName,HomeAddress:S.get('streetName'),State2:S.get('state'),Zip:S.get('zipCode'),City2:S.get('city'),DateOfBirthMmDdYyyy:S.get('dob'),SocialSecurity:S.get('ssn'),BankName:C.get('bankName'),BankRouting:C.get('routingNumber'),BankAccount2:C.get('accountNumber'),Business_Volume:C.get('monthlySales'),Signature_Url:I.get('signatureImage').get('imageFile')._url},o.go('signup.confirm')},function(I){console.log(I.messge)}):void o.go('signup')}}}]);'use strict',$(document).ready(function(){$.validator.addMethod('NotFullName',function(e,s){var o=e.match(/[^ ]+/g);if(1==o.length)return!1;var r=o.reduce(function(l,d,c){return l+(c?' ':'')+d.capitalize()},'');return $(s).val(r),!0},''),$.validator.addMethod('CountryNotSelected',function(e){return''!=e&&'Select Country'!=e}),$.validator.addMethod('ConfirmPassMatch',function(e){return e==$('input[name=\'password\']').val()},''),$.validator.addMethod('UserNameExists',function(){return!parseInt($('#username-exists').val())},''),$.validator.addMethod('EmailExists',function(){return!parseInt($('#email-exists').val())},''),$.validator.addMethod('ValidUsername',function(e){return 0>e.indexOf('@')},'')}),invoicesUnlimited.controller('SignupController',['$rootScope','$scope','$state','signUpFactory','userFactory',function(e,s,o,r,l){l.entity.length&&!r.getVerification.code()&&(showLoader(),l.logout().then(function(){hideLoader()})),$('input').keyup(function(m){var f=m.target.id;$('#'+f+'-error').css('display','none'),$('#'+f).removeClass('error')}),r.setDefaultValues(),$('#phone').mask('(Z00) 000-0000',{translation:{Z:{pattern:/[2-9]/g}}});var d=function(){$('.extended-signup').css({display:'none'})&&$('.extended-signup').show(),-1==$.inArray(s.selectedCountry,s.usaAndCanada)?($('input#email').attr('placeholder','Email'),$('input#phone').attr('placeholder','Phone Number'),r.setVerification.provider('email')):($('input#email').attr('placeholder','Email (To Recover Forgotten Password)'),$('input#phone').attr('placeholder','Phone Number (Text Verification Required)'),r.setVerification.provider('text'))},c=r.getField('User','country');c&&d(),s.selectedCountry=''==c?'Select Country':c;var g=['email','username','password','company','country'];g.forEach(function(m){$('input[name='+m+']').val(r.getField('User',m))}),$('#signUpForm').validate({onkeyup:function(m){$(m).valid()},onfocusout:!1,rules:{username:{required:!0,UserNameExists:!0,ValidUsername:!0},email:{required:!0,email:!0,EmailExists:!0},password:{required:!0,minlength:6}},messages:{username:{required:'Please specify your username !',UserNameExists:'The username is already taken!',ValidUsername:'Username cannot contain @'},email:{required:'Please specify your email !',email:'Please write valid email address',EmailExists:'The email is already taken!'},password:{required:'Please specify your password !',minlength:'Password should contain at least 6 characters'}}}),s.ValidateForm=function(m){var f=new Parse.Query(Parse.User);f.equalTo('username',$('input[name=username]').val());var y=new Parse.Query(Parse.User);y.equalTo('email',$('input[name=email]').val());var h=function(S,C){S?$('#'+C+'-exists').val(1):$('#'+C+'-exists').val(0)},I=f.first().then(function(S){h(S,'username')}),N=y.first().then(function(S){h(S,'email')});Parse.Promise.when([I,N]).then(function(){var S=$('#signUpForm').valid();m(!parseInt($('#username-exists').val())&&!parseInt($('#email-exists').val())&&S)})},s.selectedCountryChanged=function(){var m=$('#signUpForm').validate().element('[name=country]');m&&d()},s.sendMessage=function(){showLoader();s.ValidateForm(function(f){if(!f)return void hideLoader();$('#company').val($('#username').val()),$('#country').val('United States of America'),g.forEach(function(C){r.setField('User',C,$('input[name='+C+']').val())});var y=function(){var C={};console.log('invalid email address'),C.email='email address does not exist',$('#signUpForm').validate().showErrors(C),hideLoader()};r.setVerification.code('1234');var h=Parse.Object.extend('InvoiceTemplate'),I=new Parse.Query(h);I.equalTo('name','Template 1'),I.first().then(function(C){r.setField('User','defaultTemplate',C),r.signup().then(function(){var F=l.entity[0];return['BusinessInfo','AccountInfo','PrincipalInfo','Organization','Signature','Currency','Preferences','Role'].forEach(function(P){r.setField(P,'userID',F)}),['Organization','Role'].forEach(function(P){r.setField(P,'name',F.company)}),r.setField('Organization','email',F.email),r.create('Role')},function(F){console.log(F.message)}).then(function(){var F=r.create('Organization');return F},function(F){console.log(F.message)}).then(function(F){return r.copyDefaultCategories({user:l.entity[0],organization:F}).then(function(){return F})}).then(function(F){['BusinessInfo','AccountInfo','PrincipalInfo','Signature','Preferences','Currency'].forEach(function(k){r.setField(k,'organization',F)});var P=r.create('Currency'),B=r.create('Preferences');return Parse.Promise.when([P,B])},function(F){console.log(F.message)}).then(function(){hideLoader(),e.fromPaymentSettings=!1,o.go('signup.accountActivated')},function(F){return F.length?void F.forEach(function(P){console.log(P.message)}):void console.log(F.message)})});var S={};S.dest='email',S.email=$('input[name=email]').val()})},s.openPrivacyPolicy=function(){var m=$('#theFrame');m.attr('src','http://www.merchantaccountsolutions.com/Home/Privacy'),m.css('display','block')},$.reject({reject:{safari:!0,firefox:!0,msie:!0,opera:!0,konqueror:!0,unknown:!0},display:['chrome'],browserInfo:{chrome:{text:'Google Chrome',url:'http://www.google.com/chrome/'}},header:'',paragraph1:'Invoices Unlimited is optimized for Google Chrome. If you continue to use this browser you may run into some issues.',paragraph2:'Just click on the icon to get to the download page',close:!0,closeMessage:'By closing this window you acknowledge that your experience on this website may be degraded',closeLink:'Close This Window',closeESC:!0,closeCookie:!0,cookieSettings:{path:'/',expires:0},imagePath:'./assets/images/'}),s.usaAndCanada=['United States of America','Canada'],s.otherCountries=['Afghanistan','Albania','Algeria','Andorra','Angola','Antigua and Barbuda','Argentina','Armenia','Australia','Austria','Azerbaijan','Bahamas','Bahrain','Bangladesh','Barbados','Belarus','Belgium','Belize','Benin','Bhutan','Bolivia','Bosnia and Herzegovina','Botswana','Brazil','Brunei Darussalam','Bulgaria','Burkina Faso','Burundi','Cabo Verde','Cambodia','Cameroon','Central African Republic','Chad','Chile','China','Colombia','Comoros','Congo','Costa Rica','C\u0444te d\'Ivoire','Croatia','Cuba','Cyprus','Czech Republic','Democratic People\'s Republic of Korea (North Korea)','Democratic Republic of the Cong','Denmark','Djibouti','Dominica','Dominican Republic','Ecuador','Egypt','El Salvador','Equatorial Guinea','Eritrea','Estonia','Ethiopia','Fiji','Finland','France','Gabon','Gambia','Georgia','Germany','Ghana','Greece','Grenada','Guatemala','Guinea','Guinea-Bissau','Guyana','Haiti','Honduras','Hungary','Iceland','India','Indonesia','Iran','Iraq','Ireland','Israel','Italy','Jamaica','Japan','Jordan','Kazakhstan','Kenya','Kiribati','Kuwait','Kyrgyzstan','Lao People\'s Democratic Republic (Laos)','Latvia','Lebanon','Lesotho','Liberia','Libya','Liechtenstein','Lithuania','Luxembourg','Macedonia','Madagascar','Malawi','Malaysia','Maldives','Mali','Malta','Marshall Islands','Mauritania','Mauritius','Mexico','Micronesia (Federated States of)','Monaco','Mongolia','Montenegro','Morocco','Mozambique','Myanmar','Namibia','Nauru','Nepal','Netherlands','New Zealand','Nicaragua','Niger','Nigeria','Norway','Oman','Pakistan','Palau','Panama','Papua New Guinea','Paraguay','Peru','Philippines','Poland','Portugal','Qatar','Republic of Korea (South Korea)','Republic of Moldova','Romania','Russian Federation','Rwanda','Saint Kitts and Nevis','Saint Lucia','Saint Vincent and the Grenadines','Samoa','San Marino','Sao Tome and Principe','Saudi Arabia','Senegal','Serbia','Seychelles','Sierra Leone','Singapore','Slovakia','Slovenia','Solomon Islands','Somalia','South Africa','South Sudan','Spain','Sri Lanka','Sudan','Suriname','Swaziland','Sweden','Switzerland','Syrian Arab Republic','Tajikistan','Thailand','Timor-Leste','Togo','Tonga','Trinidad and Tobago','Tunisia','Turkey','Turkmenistan','Tuvalu','Uganda','Ukraine','United Arab Emirates','United Kingdom of Great Britain and Northern Ireland','United Republic of Tanzania','Uruguay','Uzbekistan','Vanuatu','Venezuela','Vietnam','Yemen','Zambia','Zimbabwe']}]);'use strict',invoicesUnlimited.controller('VerificationController',['$rootScope','$scope','$state','userFullFactory','signUpFactory','userFactory',function(e,s,o,r,l,d){if(!l.getVerification.code())return void o.go('signup');$.validator.addMethod('CodeMatch',function(){return!0}),$('#signUpForm').validate({onkeyup:function(g){$(g).valid()},onfocusout:!1,rules:{code:{required:!0,CodeMatch:!0}},messages:{code:{required:'Verification Code is empty!',CodeMatch:'Verification Code is wrong!'}}});var c=!1;s.codeChanged=function(){c&&($('#signUpForm').validate().resetForm(),c=!1)},s.verificationCodeProvider=l.getVerification.provider(),s.verifyCode=function(){return $('#signUpForm').valid()?void(showLoader(),l.signup().then(function(){var g=d.entity[0];return['BusinessInfo','AccountInfo','PrincipalInfo','Organization','Signature','Currency','Preferences','Role'].forEach(function(m){l.setField(m,'userID',g)}),['Organization','Role'].forEach(function(m){l.setField(m,'name',g.company)}),l.setField('Organization','email',g.email),l.create('Role')},function(g){console.log(g.message)}).then(function(){var g=l.create('Organization');return g},function(g){console.log(g.message)}).then(function(g){return l.copyDefaultCategories({user:d.entity[0],organization:g}).then(function(){return g})}).then(function(g){['BusinessInfo','AccountInfo','PrincipalInfo','Signature','Preferences','Currency'].forEach(function(y){l.setField(y,'organization',g)});var m=l.create('Currency'),f=l.create('Preferences');return Parse.Promise.when([m,f])},function(g){console.log(g.message)}).then(function(){hideLoader(),e.fromPaymentSettings=!1,o.go('signup.business-info')},function(g){return g.length?void g.forEach(function(m){console.log(m.message)}):void console.log(g.message)})):void(c=!0)},s.changePhoneNumber=function(){o.go('signup')}}]);